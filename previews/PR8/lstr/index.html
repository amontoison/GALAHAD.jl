<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>lstr · GALAHAD.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="GALAHAD.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GALAHAD.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../arc/">arc</a></li><li><a class="tocitem" href="../bgo/">bgo</a></li><li><a class="tocitem" href="../blls/">blls</a></li><li><a class="tocitem" href="../bqpb/">bqpb</a></li><li><a class="tocitem" href="../bqp/">bqp</a></li><li><a class="tocitem" href="../bsc/">bsc</a></li><li><a class="tocitem" href="../ccqp/">ccqp</a></li><li><a class="tocitem" href="../clls/">clls</a></li><li><a class="tocitem" href="../convert/">convert</a></li><li><a class="tocitem" href="../cqp/">cqp</a></li><li><a class="tocitem" href="../cro/">cro</a></li><li><a class="tocitem" href="../dgo/">dgo</a></li><li><a class="tocitem" href="../dps/">dps</a></li><li><a class="tocitem" href="../eqp/">eqp</a></li><li><a class="tocitem" href="../fdc/">fdc</a></li><li><a class="tocitem" href="../fit/">fit</a></li><li><a class="tocitem" href="../gls/">gls</a></li><li><a class="tocitem" href="../gltr/">gltr</a></li><li><a class="tocitem" href="../hash/">hash</a></li><li><a class="tocitem" href="../icfs/">icfs</a></li><li><a class="tocitem" href="../ir/">ir</a></li><li><a class="tocitem" href="../lhs/">lhs</a></li><li><a class="tocitem" href="../lms/">lms</a></li><li><a class="tocitem" href="../lpa/">lpa</a></li><li><a class="tocitem" href="../lpb/">lpb</a></li><li><a class="tocitem" href="../lsqp/">lsqp</a></li><li><a class="tocitem" href="../lsrt/">lsrt</a></li><li class="is-active"><a class="tocitem" href>lstr</a><ul class="internal"><li><a class="tocitem" href="#Purpose"><span>Purpose</span></a></li><li><a class="tocitem" href="#Authors"><span>Authors</span></a></li><li><a class="tocitem" href="#Originally-released"><span>Originally released</span></a></li><li><a class="tocitem" href="#Terminology"><span>Terminology</span></a></li><li><a class="tocitem" href="#Method"><span>Method</span></a></li><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li><li><a class="tocitem" href="#Call-order"><span>Call order</span></a></li></ul></li><li><a class="tocitem" href="../nls/">nls</a></li><li><a class="tocitem" href="../presolve/">presolve</a></li><li><a class="tocitem" href="../psls/">psls</a></li><li><a class="tocitem" href="../qpb/">qpb</a></li><li><a class="tocitem" href="../roots/">roots</a></li><li><a class="tocitem" href="../rpd/">rpd</a></li><li><a class="tocitem" href="../rqs/">rqs</a></li><li><a class="tocitem" href="../sbls/">sbls</a></li><li><a class="tocitem" href="../scu/">scu</a></li><li><a class="tocitem" href="../sec/">sec</a></li><li><a class="tocitem" href="../sha/">sha</a></li><li><a class="tocitem" href="../sils/">sils</a></li><li><a class="tocitem" href="../slls/">slls</a></li><li><a class="tocitem" href="../sls/">sls</a></li><li><a class="tocitem" href="../trb/">trb</a></li><li><a class="tocitem" href="../trs/">trs</a></li><li><a class="tocitem" href="../tru/">tru</a></li><li><a class="tocitem" href="../ugo/">ugo</a></li><li><a class="tocitem" href="../uls/">uls</a></li><li><a class="tocitem" href="../wcp/">wcp</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>lstr</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>lstr</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/amontoison/GALAHAD.jl/blob/main/docs/src/lstr.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h1><h2 id="Purpose"><a class="docs-heading-anchor" href="#Purpose">Purpose</a><a id="Purpose-1"></a><a class="docs-heading-anchor-permalink" href="#Purpose" title="Permalink"></a></h2><p>Given a real <span>$m$</span> by <span>$n$</span> matrix <span>$A$</span>, a real <span>$m$</span> vector <span>$b$</span> and a scalar <span>$\Delta&gt;0$</span>, this package finds an ** approximate minimizer of <span>$\| A x - b\|_2$</span>, where the vector <span>$x$</span> is required to satisfy the “trust-region” constraint <span>$\|x\|_2 \leq\Delta$</span>.** This problem commonly occurs as a trust-region subproblem in nonlinear optimization calculations, and may be used to regularize the solution of under-determined or ill-conditioned linear least-squares problems. The method may be suitable for large <span>$m$</span> and/or <span>$n$</span> as no factorization involving <span>$A$</span> is required. Reverse communication is used to obtain matrix-vector products of the form <span>$u + A v$</span> and <span>$v + A^T u$</span>.</p><h2 id="Authors"><a class="docs-heading-anchor" href="#Authors">Authors</a><a id="Authors-1"></a><a class="docs-heading-anchor-permalink" href="#Authors" title="Permalink"></a></h2><p>N. I. M. Gould, STFC-Rutherford Appleton Laboratory, England.</p><p>C interface, additionally J. Fowkes, STFC-Rutherford Appleton Laboratory.</p><p>Julia interface, additionally A. Montoison and D. Orban, Polytechnique Montréal.</p><h2 id="Originally-released"><a class="docs-heading-anchor" href="#Originally-released">Originally released</a><a id="Originally-released-1"></a><a class="docs-heading-anchor-permalink" href="#Originally-released" title="Permalink"></a></h2><p>November 2007, C interface December 2021.</p><h2 id="Terminology"><a class="docs-heading-anchor" href="#Terminology">Terminology</a><a id="Terminology-1"></a><a class="docs-heading-anchor-permalink" href="#Terminology" title="Permalink"></a></h2><p>The required solution <span>$x$</span> necessarily satisfies the optimality condition <span>$A^T ( A x - b ) + \lambda x = 0$</span>, where <span>$\lambda \geq 0$</span> is a Lagrange multiplier corresponding to the trust-region constraint <span>$\|x\|_2\leq\Delta$</span>.</p><h2 id="Method"><a class="docs-heading-anchor" href="#Method">Method</a><a id="Method-1"></a><a class="docs-heading-anchor-permalink" href="#Method" title="Permalink"></a></h2><p>The method is iterative. Startingwith the vector <span>$u_1 = b$</span>, a bi-diagonalisation process is used to generate the vectors <span>$v_k$</span> and <span>$u_k+1$</span> so that the <span>$n$</span> by <span>$k$</span> matrix <span>$V_k = ( v_1 \ldots v_k)$</span> and the <span>$m$</span> by <span>$(k+1)$</span> matrix <span>$U_k = ( u_1 \ldots u_{k+1})$</span> together satisfy <span>$A V_k = U_{k+1} B_k \;\mbox{and}\; b = \|b\| U_{k+1} e_1,$</span> \n  A V<em>k = U</em>{k+1} B<em>k and b = ||b|| U</em>{k+1} e<em>1, \n where B</em>k$ is <span>$(k+1)$</span> by <span>$k$</span> and lower bi-diagonal, <span>$U_k$</span> and <span>$V_k$</span> have orthonormal columns and <span>$e_1$</span> is the first unit vector. The solution sought is of the form <span>$x_k = V_k y_k$</span>, where <span>$y_k$</span> solves the bi-diagonal least-squares trust-region problem <span>$(1) \;\;\; \min \| B_k y - \|b\| e_1 \|_2 \;\mbox{subject to}\; \|y\|_2 \leq \Delta.$</span> \n  (1)min || B<em>k y - \|b\| e</em>1 ||<em>2 subject to ||y||</em>2 &lt;= Delta. \n</p><p>If the trust-region constraint is inactive, the solution <span>$y_k$</span> may be found, albeit indirectly, via the LSQR algorithm of Paige and Saunders which solves the bi-diagonal least-squares problem $ \min \| B<em>k y - \|b\| e</em>1 \|<em>2$ \n  min || B</em>k y - ||b|| e<em>1 ||</em>2 \n using a QR factorization of <span>$B_k$</span>. Only the most recent <span>$v_k$</span> and <span>$u_{k+1}$</span> are required, and their predecessors discarded, to compute <span>$x_k$</span> from <span>$x_{k-1}$</span>. This method has the important property that the iterates <span>$y$</span> (and thus <span>$x_k$</span>) generated increase in norm with <span>$k$</span>. Thus as soon as an LSQR iterate lies outside the trust-region, the required solution to (1) and thus to the original problem must lie on the boundary of the trust-region.</p><p>If the solution is so constrained, the simplest strategy is to interpolate the last interior iterate with the newly discovered exterior one to find the boundary point–-the so-called Steihaug-Toint point–-between them. Once the solution is known to lie on the trust-region boundary, further improvement may be made by solving $ \min \| B<em>k y - \|b\| e</em>1 \|<em>2 \;\mbox{subject to}\;|\|y\|</em>2 = \Delta,$ \n  min || B<em>k y - ||b|| e</em>1 ||<em>2 subject to ||y||</em>2 = Delta, \n for which the optimality conditions require that <span>$y_k = y(\lambda_k)$</span> where <span>$\lambda_k$</span> is the positive root of <span>$B_k^T ( B_k^{} y(\lambda) - \|b\| e_1^{} ) + \lambday(\lambda) = 0 \;\mbox{and}\;\|y(\lambda)\|_2 = \Delta$</span> \n B<em>k^T ( B</em>k y(lambda) - ||b|| e<em>1 ) + lambda y(lambda) = 0 and ||y(lambda)||</em>2 = Delta \n The vector <span>$y(\lambda)$</span> is equivalently the solution to the regularized least-squares problem <span>$\min\left \| \vect{ B_k \\ \lambda^{\frac{1}{2}} I } y - \|b\| e_1^{} \right \|$</span> \n min||B<em>k y - ||b|| e</em>1 ||  ||lambda^{1/2} y|| \n and may be found efficiently. Given<span>$y(\lambda)$</span>, Newton&#39;s method is then used to find <span>$\lambda_k$</span> as the positive root of <span>$\|y(\lambda)\|_2 = \Delta$</span>. Unfortunately, unlike when the solution lies in the interior of the trust-region, it is not known how to recur <span>$x_k$</span> from <span>$x_{k-1}$</span> given <span>$y_k$</span>, and a second pass in which <span>$x_k = V_k y_k$</span> is regenerated is needed–-this need only be done once <span>$x_k$</span> has implicitly deemed to be sufficiently close to optimality. As this second pass is an additional expense, a record is kept of the optimal objective function values for each value of <span>$k$</span>, and the second pass is only performed so far as to ensure a given fraction of the final optimal objective value. Large savings may be made in the second pass by choosing the required fraction to be significantly smaller than one.</p><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><p>A complete description of the unconstrained case is given by</p><p>C. C. Paige and M. A. Saunders, LSQR: an algorithm for sparse linear equations and sparse leastsquares. ACM Transactions on Mathematical Software, 8(1):43–71, 1982</p><p>and</p><p>C. C. Paige and M. A. Saunders, ALGORITHM 583: LSQR: an algorithm for sparse linear equations and sparse least squares. ACM Transactions on Mathematical Software, 8(2):195–209, 1982.</p><p>Additional details on how to proceed once the trust-region constraint is encountered are described in detail in</p><p>C. Cartis, N. I. M. Gould and Ph. L. Toint, Trust-region and other regularisation of linear least-squares problems. BIT 49(1):21-53 (2009).</p><h2 id="Call-order"><a class="docs-heading-anchor" href="#Call-order">Call order</a><a id="Call-order-1"></a><a class="docs-heading-anchor-permalink" href="#Call-order" title="Permalink"></a></h2><p>To solve a given problem, functions from the lstr package must be called in the following order:</p><ul><li>lstr_initialize - provide default control parameters and set up initial data structures</li><li>lstr_read_specfile (optional) - override control values by reading replacement values from a file</li><li>lstr_import_control - import control parameters prior to</li></ul><p>solution</p><ul><li>lstr_solve_problem - solve the problem by reverse</li></ul><p>communication, a sequence of calls are made under control of a status parameter, each exit either asks the user to provide additional informaton and to re-enter, or reports that either the solution has been found or that an error has occurred</p><ul><li>lstr_information (optional) - recover information about the solution and solution process</li><li>lstr_terminate - deallocate data structures</li></ul><p>See Section~\ref{examples} for an example of use. See the &lt;a href=&quot;examples.html&quot;&gt;examples tab&lt;/a&gt; for an illustration of use. See the examples section for an illustration of use.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../lsrt/">« lsrt</a><a class="docs-footer-nextpage" href="../nls/">nls »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 7 December 2022 22:13">Wednesday 7 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
