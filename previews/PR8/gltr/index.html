<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>gltr · GALAHAD.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="GALAHAD.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GALAHAD.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../arc/">arc</a></li><li><a class="tocitem" href="../bgo/">bgo</a></li><li><a class="tocitem" href="../blls/">blls</a></li><li><a class="tocitem" href="../bqpb/">bqpb</a></li><li><a class="tocitem" href="../bqp/">bqp</a></li><li><a class="tocitem" href="../bsc/">bsc</a></li><li><a class="tocitem" href="../ccqp/">ccqp</a></li><li><a class="tocitem" href="../clls/">clls</a></li><li><a class="tocitem" href="../convert/">convert</a></li><li><a class="tocitem" href="../cqp/">cqp</a></li><li><a class="tocitem" href="../cro/">cro</a></li><li><a class="tocitem" href="../dgo/">dgo</a></li><li><a class="tocitem" href="../dps/">dps</a></li><li><a class="tocitem" href="../eqp/">eqp</a></li><li><a class="tocitem" href="../fdc/">fdc</a></li><li><a class="tocitem" href="../fit/">fit</a></li><li><a class="tocitem" href="../gls/">gls</a></li><li class="is-active"><a class="tocitem" href>gltr</a><ul class="internal"><li><a class="tocitem" href="#Purpose"><span>Purpose</span></a></li><li><a class="tocitem" href="#Authors"><span>Authors</span></a></li><li><a class="tocitem" href="#Originally-released"><span>Originally released</span></a></li><li><a class="tocitem" href="#Terminology"><span>Terminology</span></a></li><li><a class="tocitem" href="#Method"><span>Method</span></a></li><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li><li><a class="tocitem" href="#Call-order"><span>Call order</span></a></li></ul></li><li><a class="tocitem" href="../hash/">hash</a></li><li><a class="tocitem" href="../icfs/">icfs</a></li><li><a class="tocitem" href="../ir/">ir</a></li><li><a class="tocitem" href="../lhs/">lhs</a></li><li><a class="tocitem" href="../lms/">lms</a></li><li><a class="tocitem" href="../lpa/">lpa</a></li><li><a class="tocitem" href="../lpb/">lpb</a></li><li><a class="tocitem" href="../lsqp/">lsqp</a></li><li><a class="tocitem" href="../lsrt/">lsrt</a></li><li><a class="tocitem" href="../lstr/">lstr</a></li><li><a class="tocitem" href="../nls/">nls</a></li><li><a class="tocitem" href="../presolve/">presolve</a></li><li><a class="tocitem" href="../psls/">psls</a></li><li><a class="tocitem" href="../qpb/">qpb</a></li><li><a class="tocitem" href="../roots/">roots</a></li><li><a class="tocitem" href="../rpd/">rpd</a></li><li><a class="tocitem" href="../rqs/">rqs</a></li><li><a class="tocitem" href="../sbls/">sbls</a></li><li><a class="tocitem" href="../scu/">scu</a></li><li><a class="tocitem" href="../sec/">sec</a></li><li><a class="tocitem" href="../sha/">sha</a></li><li><a class="tocitem" href="../sils/">sils</a></li><li><a class="tocitem" href="../slls/">slls</a></li><li><a class="tocitem" href="../sls/">sls</a></li><li><a class="tocitem" href="../trb/">trb</a></li><li><a class="tocitem" href="../trs/">trs</a></li><li><a class="tocitem" href="../tru/">tru</a></li><li><a class="tocitem" href="../ugo/">ugo</a></li><li><a class="tocitem" href="../uls/">uls</a></li><li><a class="tocitem" href="../wcp/">wcp</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>gltr</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>gltr</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/amontoison/GALAHAD.jl/blob/main/docs/src/gltr.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h1><h2 id="Purpose"><a class="docs-heading-anchor" href="#Purpose">Purpose</a><a id="Purpose-1"></a><a class="docs-heading-anchor-permalink" href="#Purpose" title="Permalink"></a></h2><p>Given real <span>$n$</span> by <span>$n$</span> symmetric matrices <span>$H$</span> and <span>$M$</span> (with <span>$M$</span> positive definite), a real <span>$n$</span> vector <span>$c$</span> and scalars <span>$\Delta&gt;0$</span> and <span>$f_0$</span>, this package finds an ** approximate minimizer of the quadratic objective function <span>$\frac{1}{2} x^T H x+c^T x + f_0$</span>, where the vector <span>$x$</span> is required to satisfy the constraint <span>$\|x\|_M \leq\Delta$</span>**, and where the <span>$M$</span>-norm of <span>$x$</span> is <span>$\|x\|_M = \sqrt{x^T M x}$</span>. This problem commonly occurs as a trust-region subproblem in nonlinear optimization calculations. The method may be suitable for large <span>$n$</span> as no factorization of <span>$H$</span> is required. Reverse communication is used to obtain matrix-vector products of the form <span>$H z$</span> and <span>$M^{-1} z$</span>.</p><p>The package may also be used to solve the related problem in which <span>$x$</span> is instead required to satisfy the <strong>equality constraint <span>$\|x\|_M = \Delta$</span></strong>.</p><h2 id="Authors"><a class="docs-heading-anchor" href="#Authors">Authors</a><a id="Authors-1"></a><a class="docs-heading-anchor-permalink" href="#Authors" title="Permalink"></a></h2><p>N. I. M. Gould, STFC-Rutherford Appleton Laboratory, England.</p><p>C interface, additionally J. Fowkes, STFC-Rutherford Appleton Laboratory.</p><p>Julia interface, additionally A. Montoison and D. Orban, Polytechnique Montréal.</p><h2 id="Originally-released"><a class="docs-heading-anchor" href="#Originally-released">Originally released</a><a id="Originally-released-1"></a><a class="docs-heading-anchor-permalink" href="#Originally-released" title="Permalink"></a></h2><p>April 1997, C interface December 2021.</p><h2 id="Terminology"><a class="docs-heading-anchor" href="#Terminology">Terminology</a><a id="Terminology-1"></a><a class="docs-heading-anchor-permalink" href="#Terminology" title="Permalink"></a></h2><h2 id="Method"><a class="docs-heading-anchor" href="#Method">Method</a><a id="Method-1"></a><a class="docs-heading-anchor-permalink" href="#Method" title="Permalink"></a></h2><p>The required solution <span>$x$</span> necessarily satisfies the optimality condition <span>$H x + \lambda M x + c = 0$</span>, where <span>$\lambda \geq 0$</span>is a Lagrange multiplier corresponding to the constraint <span>$\|x\|_M\leq\Delta$</span>. In addition, the matrix <span>$H + \lambda M$</span> will be positive definite.</p><p>The method is iterative. Startingwith the vector <span>$M^{-1} c$</span>, a matrix of Lanczos vectors is built one column at a time so that the <span>$k$</span>-th column is generated during iteration <span>$k$</span>. These columns span a so-called Krylov space. The resulting <span>$n$</span> by <span>$k$</span> matrix <span>$Q_k $ has the property that $Q_k^T H Q_k^{}=T_k^{}$</span>, where <span>$T_k$</span> is tridiagonal. An approximation to the required solution may then be expressed formally as <span>$x_{k+1}=Q_k y_k,$</span> \n  x<em>{k+1}=Q</em>k y<em>k, \n where y</em>k $ solves the “tridiagonal” subproblem of minimizing <span>$(1) \;\;\; \frac{1}{2} y^T T_k y+ \|c\|_{M^{-1}} e_1^T y\;\mbox{subject to the constraint}\; \|y\|_2\leq\Delta,$</span> \n (1)1/2 y^T T<em>k y+ ||c||</em>M^{-1} e<em>1^T y  subject to the constraint \|y\|</em>2leqDelta, \n and where <span>$e_1$</span> is the first unit vector.</p><p>If the solution to (1) lies interior to the constraint, the required solution <span>$x_{k+1}$</span> may simply be found as the <span>$k$</span>-th (preconditioned) conjugate-gradient iterate. This solution can be obtained without the need to access the whole matrix <span>$Q_k$</span>. These conjugate-gradient iterates  increase in <span>$M$</span>-norm, and thus once one of them exceeds <span>$\Delta$</span> in <span>$M$</span>-norm, the solution must occur on the constraint boundary. Thereafter, the solution to (1) is less easy to obtain, but an efficient inner iteration to solve (1) is nonetheless achievable because <span>$T_k $ is tridiagonal. It is possible to observe the optimality measure $\|H x+\lambda M x+c\|_{M^{-1}}$</span> without computing <span>$x_{k+1}$</span>, and thus without needing <span>$Q_k $. Once this measure is sufficiently small, a second pass is required to obtain the estimate $x_{k+1} $ from $y_k $. As this second pass is an additional expense, a record is kept of the optimal objective function values for each value of $k$</span>, and the second pass is only performed so far as to ensure a given fraction of the final optimal objective value. Large savings may be made in the second pass by choosing the required fraction to be significantly smaller than one.</p><p>A cheaper alternative is to use the Steihuag-Toint strategy, which is simply to stop at the first boundary point encountered along the piecewise linear path generated by the conjugate-gradient iterates. Note that if <span>$H$</span> is significantly indefinite, this strategy often produces a far from optimal point, but is effective when <span>$H$</span> is positive definite or almost</p><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><p>The method is described in detail in</p><p>N. I. M. Gould, S. Lucidi, M. Roma and Ph. L. Toint, Solving the trust-region subproblem using the Lanczos method. SIAM Journal on Optimization <strong>9:2</strong> (1999), 504-525.</p><h2 id="Call-order"><a class="docs-heading-anchor" href="#Call-order">Call order</a><a id="Call-order-1"></a><a class="docs-heading-anchor-permalink" href="#Call-order" title="Permalink"></a></h2><p>To solve a given problem, functions from the gltr package must be called in the following order:</p><ul><li>gltr_initialize - provide default control parameters and set up initial data structures</li><li>gltr_read_specfile (optional) - override control values by reading replacement values from a file</li><li>gltr_import_control - import control parameters prior to</li></ul><p>solution</p><ul><li>gltr_solve_problem - solve the problem by reverse</li></ul><p>communication, a sequence of calls are made under control of a status parameter, each exit either asks the user to provide additional informaton and to re-enter, or reports that either the solution has been found or that an error has occurred</p><ul><li>gltr_information (optional) - recover information about the solution and solution process</li><li>gltr_terminate - deallocate data structures</li></ul><p>See Section~\ref{examples} for an example of use. See the &lt;a href=&quot;examples.html&quot;&gt;examples tab&lt;/a&gt; for an illustration of use. See the examples section for an illustration of use.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../gls/">« gls</a><a class="docs-footer-nextpage" href="../hash/">hash »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Friday 21 July 2023 08:12">Friday 21 July 2023</span>. Using Julia version 1.9.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
