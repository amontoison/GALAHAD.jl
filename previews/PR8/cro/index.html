<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>cro · GALAHAD.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/style.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="GALAHAD.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">GALAHAD.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../arc/">arc</a></li><li><a class="tocitem" href="../bgo/">bgo</a></li><li><a class="tocitem" href="../blls/">blls</a></li><li><a class="tocitem" href="../bqpb/">bqpb</a></li><li><a class="tocitem" href="../bqp/">bqp</a></li><li><a class="tocitem" href="../bsc/">bsc</a></li><li><a class="tocitem" href="../ccqp/">ccqp</a></li><li><a class="tocitem" href="../clls/">clls</a></li><li><a class="tocitem" href="../convert/">convert</a></li><li><a class="tocitem" href="../cqp/">cqp</a></li><li class="is-active"><a class="tocitem" href>cro</a><ul class="internal"><li><a class="tocitem" href="#Purpose"><span>Purpose</span></a></li><li><a class="tocitem" href="#Authors"><span>Authors</span></a></li><li><a class="tocitem" href="#Originally-released"><span>Originally released</span></a></li><li><a class="tocitem" href="#Terminology"><span>Terminology</span></a></li><li><a class="tocitem" href="#Method"><span>Method</span></a></li><li><a class="tocitem" href="#Reference"><span>Reference</span></a></li><li><a class="tocitem" href="#Call-order"><span>Call order</span></a></li><li><a class="tocitem" href="#fdc*array*indexing-Array-indexing"><span>fdc<em>array</em>indexing Array indexing</span></a></li></ul></li><li><a class="tocitem" href="../dgo/">dgo</a></li><li><a class="tocitem" href="../dps/">dps</a></li><li><a class="tocitem" href="../eqp/">eqp</a></li><li><a class="tocitem" href="../fdc/">fdc</a></li><li><a class="tocitem" href="../fit/">fit</a></li><li><a class="tocitem" href="../gls/">gls</a></li><li><a class="tocitem" href="../gltr/">gltr</a></li><li><a class="tocitem" href="../hash/">hash</a></li><li><a class="tocitem" href="../icfs/">icfs</a></li><li><a class="tocitem" href="../ir/">ir</a></li><li><a class="tocitem" href="../lhs/">lhs</a></li><li><a class="tocitem" href="../lms/">lms</a></li><li><a class="tocitem" href="../lpa/">lpa</a></li><li><a class="tocitem" href="../lpb/">lpb</a></li><li><a class="tocitem" href="../lsqp/">lsqp</a></li><li><a class="tocitem" href="../lsrt/">lsrt</a></li><li><a class="tocitem" href="../lstr/">lstr</a></li><li><a class="tocitem" href="../nls/">nls</a></li><li><a class="tocitem" href="../presolve/">presolve</a></li><li><a class="tocitem" href="../psls/">psls</a></li><li><a class="tocitem" href="../qpb/">qpb</a></li><li><a class="tocitem" href="../roots/">roots</a></li><li><a class="tocitem" href="../rpd/">rpd</a></li><li><a class="tocitem" href="../rqs/">rqs</a></li><li><a class="tocitem" href="../sbls/">sbls</a></li><li><a class="tocitem" href="../scu/">scu</a></li><li><a class="tocitem" href="../sec/">sec</a></li><li><a class="tocitem" href="../sha/">sha</a></li><li><a class="tocitem" href="../sils/">sils</a></li><li><a class="tocitem" href="../slls/">slls</a></li><li><a class="tocitem" href="../sls/">sls</a></li><li><a class="tocitem" href="../trb/">trb</a></li><li><a class="tocitem" href="../trs/">trs</a></li><li><a class="tocitem" href="../tru/">tru</a></li><li><a class="tocitem" href="../ugo/">ugo</a></li><li><a class="tocitem" href="../uls/">uls</a></li><li><a class="tocitem" href="../wcp/">wcp</a></li><li><a class="tocitem" href="../reference/">Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>cro</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>cro</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/amontoison/GALAHAD.jl/blob/main/docs/src/cro.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Introduction"><a class="docs-heading-anchor" href="#Introduction">Introduction</a><a id="Introduction-1"></a><a class="docs-heading-anchor-permalink" href="#Introduction" title="Permalink"></a></h1><h2 id="Purpose"><a class="docs-heading-anchor" href="#Purpose">Purpose</a><a id="Purpose-1"></a><a class="docs-heading-anchor-permalink" href="#Purpose" title="Permalink"></a></h2><p>Provides a <strong>crossover</strong> from a solution to the <strong>convex quadratic programming problem</strong> <span>$\mbox{minimize}\;\; q(x) = \frac{1}{2} x^T H x + g^T x + f $ \[ minimize q(x) := 1/2 x^T H x + g^T x + f \] subject to the general linear constraints $c_i^l\leqa_i^Tx\leq c_i^u, \;\;\; i = 1, \ldots , m,$</span> \n  c<em>i^l [&lt;=] a</em>i^Tx [&lt;=] c<em>i^u, i = 1, ... , m, \n and the simple bound constraints x</em>j^l\leqx<em>j \leq x</em>j^u, \;\;\; j = 1, \ldots , n,$ \n  x<em>j^l [&lt;=] x</em>j [&lt;=] x<em>j^u, j = 1, ... , n, \n found by an interior-point method to one in which the <strong>matrix of defining active constraints/variables is of full rank.</strong> Here, the <span>$n$</span> by <span>$n$</span> symmetric, positive-semi-definite matrix <span>$H$</span>, the vectors <span>$g$</span>, a</em>i<span>$, $c^l$</span>, <span>$c^u$</span>, <span>$x^l$</span>, <span>$x^u$</span>, the scalar <span>$f$</span> are given. In addition a solution <span>$x$</span> along with optimal Lagrange multipliers <span>$y$</span> for the general constraints and dual variables <span>$z$</span> for the simple bounds must be provided (see Section~\ref{galmethod}). These will be adjusted as necessary. Any of the constraint bounds <span>$c_i^l$</span>, <span>$c_i^u$</span>, <span>$x_j^l$</span> and <span>$x_j^u$</span> may be infinite. Full advantage is taken of any zero coefficients in the matrix <span>$H$</span> or the matrix <span>$A$</span> of vectors <span>$a_i$</span>.</p><h2 id="Authors"><a class="docs-heading-anchor" href="#Authors">Authors</a><a id="Authors-1"></a><a class="docs-heading-anchor-permalink" href="#Authors" title="Permalink"></a></h2><p>N. I. M. Gould, STFC-Rutherford Appleton Laboratory, England.</p><p>C interface, additionally J. Fowkes, STFC-Rutherford Appleton Laboratory.</p><p>Julia interface, additionally A. Montoison and D. Orban, Polytechnique Montréal.</p><h2 id="Originally-released"><a class="docs-heading-anchor" href="#Originally-released">Originally released</a><a id="Originally-released-1"></a><a class="docs-heading-anchor-permalink" href="#Originally-released" title="Permalink"></a></h2><p>August 2010, C interface January 2022.</p><h2 id="Terminology"><a class="docs-heading-anchor" href="#Terminology">Terminology</a><a id="Terminology-1"></a><a class="docs-heading-anchor-permalink" href="#Terminology" title="Permalink"></a></h2><p>Any required solution <span>$x$</span> necessarily satisfies the primal optimality conditions <span>$\mbox{(1a) $\hspace{66mm} A x = c\hspace{66mm}$</span>}$ \n (1a) A x = c \n and <span>$\mbox{(1b) $\hspace{52mm} c^l \leq c \leq c^u, \;\; x^l \leq x \leq x^u,\hspace{52mm}$</span>} $ \n (1b) c^l [&lt;=] c [&lt;=] c^u, x^l [&lt;=] x [&lt;=] x^u, \n the dual optimality conditions <span>$\mbox{(2a) $\hspace{58mm} H x + g = A^T y + z\hspace{58mm}$</span>}$ \n (2a) H x + g = A^T y + z \n where <span>$\mbox{(2b) $\hspace{24mm} y = y^l + y^u, \;\; z = z^l + z^u, \,\,  y^l \geq 0 , \;\;y^u \leq 0 , \;\;  z^l \geq 0 \;\; \mbox{and} \;\; z^u \leq 0,\hspace{24mm}$</span>} $ \n  (2b) y = y^l + y^u, z = z^l + z^u, y^l [&gt;=] 0, y^u [&lt;=] 0, z^l [&gt;=] 0 and z^u [&lt;=] 0, \n and the complementary slackness conditions <span>$\mbox{(3) $\hspace{12mm} ( A x - c^l )^T y^l = 0,\;\;( A x - c^u )^T y^u = 0,\;\; (x -x^l )^T z^l = 0 \;\;\mbox{and} \;\; (x -x^u )^T z^u = 0,\hspace{12mm} $}$</span> \n (3) (A x - c^l)^T y^l = 0, (A x - c^u)^T y^u = 0, (x -x^l)^T z^l = 0 and (x -x^u)^T z^u = 0, \n where the vectors <span>$y$</span> and <span>$z$</span> are known as the Lagrange multipliers for the general linear constraints, and the dual variables for the bounds, respectively, and where the vector inequalities hold component-wise.</p><h2 id="Method"><a class="docs-heading-anchor" href="#Method">Method</a><a id="Method-1"></a><a class="docs-heading-anchor-permalink" href="#Method" title="Permalink"></a></h2><p>Denote the active constraints by <span>$A_A x = c_A$</span> and the active bounds by <span>$I_A x = x_A$</span>. Then any optimal solution satisfies the linear system <span>$\left(\begin{array}{ccc}H &amp; - A_A^T &amp; - I^T_A \\ A_A &amp; 0 &amp; 0 \\ I_A &amp; 0 &amp; 0 \end{array}\right) \left(\begin{array}{c}x \\ y_A \\ z_A\end{array}\right) = \left(\begin{array}{c}- g \\ c_A \\ x_A\end{array}\right).$</span> \n  ( H - A<em>A^T - I</em>A^T ) (x) ( - g )  ( A<em>A 0 0 ) ( y</em>A ) = ( c<em>A ),  ( I</em>A 0 0 ) ( z<em>A ) ( x</em>A ) \n where <span>$y_A$</span> and <span>$z_A$</span> are the corresponding active Lagrange multipliers and dual variables respectively. Consequently the difference between any two solutions <span>$(\Delta x, \Delta y, \Delta z)$</span> must satisfy <span>$\mbox{(4)}\;\; \left(\begin{array}{ccc}H &amp; - A_A^T &amp; - I^T_A \\ A_A &amp; 0 &amp; 0 \\ I_A &amp; 0 &amp; 0 \end{array}\right) \left(\begin{array}{c}\Delta x \\ \Delta y_A \\ \Delta z_A\end{array}\right) = 0.$</span> \n ( H - A<em>A^T - I</em>A^T ) (Delta x) (4) ( A<em>A 0 0 ) ( Delta y</em>A ) = 0, ( I<em>A 0 0 ) ( Delta z</em>A ) \n Thus there can only be multiple solution if the coefficient matrix <span>$K$</span> of (4) is singular. The algorithm used in CRO exploits this. The matrix <span>$K$</span> is checked for singularity using the GALAHAD package ULS. If <span>$K$</span> is non singular, the solution is unique and the solution input by the user provides a linearly independent active set. Otherwise <span>$K$</span> is singular, and partitions <span>$A_A^T = ( A_B^T \;\; A_N^T)$</span> and <span>$I_A^T = ( I_B^T \;\; I_N^T)$</span> are found so that <span>$\left(\begin{array}{ccc}H &amp; - A_B^T &amp; - I_B^T \\ A_B &amp; 0 &amp; 0 \\ I_B &amp; 0 &amp; 0 \end{array}\right)$</span> \n  ( H - A<em>B^T - I</em>B^T )  ( A<em>B 0 0 )  ( I</em>B 0 0 ) \n is non-singular and the <strong>non-basic</strong> constraints <span>$A_N^T$</span> and <span>$I_N^T$</span> are linearly dependent on the <strong>basic</strong> ones <span>$( A_B^T \;\; I_B^T)$</span>. In this case (4) is equivalent to <span>$\mbox{(5)}\;\; \left(\begin{array}{ccc}H &amp; - A_B^T &amp; - I_B^T \\ A_B &amp; 0 &amp; 0 \\ I_B &amp; 0 &amp; 0 \end{array}\right) = \left(\begin{array}{c}A_N^T \\ 0 \\ 0\end{array}\right) \Delta y_N + \left(\begin{array}{c}I_N^T \\ 0 \\ 0\end{array}\right) \Delta z_N$</span> \n ( H - A<em>B^T - I</em>B^T ) (Delta x) (5) ( A<em>B 0 0 ) ( Delta y</em>A ) = ( I<em>B 0 0 ) ( Delta z</em>A )</p><p>( A<em>N^T ) ( I</em>N^T ) ( 0 ) Delta y<em>N + ( 0 ) Delta z</em>N. ( 0 ) ( 0 ) \n Thus, starting from the user&#39;s <span>$(x, y, z)$</span> and with a factorization of the coefficient matrix of (5) found by the GALAHAD package SLS, the alternative solution <span>$(x + \alpha x, y + \alpha y, z + \alpha z)$</span>, featuring <span>$(\Delta x, \Delta y_B, \Delta z_B)$</span> from (5)in which successively one of the components of <span>$\Delta y_N$</span> and <span>$\Delta z_N$</span> in turn is non zero, is taken. The scalar <span>$\alpha$</span> at each stage is chosen to be the largest possible that guarantees (2.b); this may happen when a non-basic multiplier/dual variable reaches zero, in which case the corresponding constraint is disregarded, or when this happens for a basic multiplier/dual variable, in which case this constraint is exchanged with the non-basic one under consideration and disregarded. The latter corresponds to changing the basic-non-basic partition in (5), and subsequent solutions may be found by updating the factorization of the coefficient matrix in (5) following the basic-non-basic swap using the GALAHAD package SCU.</p><h2 id="Reference"><a class="docs-heading-anchor" href="#Reference">Reference</a><a id="Reference-1"></a><a class="docs-heading-anchor-permalink" href="#Reference" title="Permalink"></a></h2><h2 id="Call-order"><a class="docs-heading-anchor" href="#Call-order">Call order</a><a id="Call-order-1"></a><a class="docs-heading-anchor-permalink" href="#Call-order" title="Permalink"></a></h2><p>To solve a given problem, functions from the cro package must be called in the following order:</p><ul><li>cro_initialize - provide default control parameters and set up initial data structures</li><li>cro_read_specfile (optional) - override control values by reading replacement values from a file</li><li>cro<em>crossover</em>solution - move from a primal-dual soution</li></ul><p>to a full rank one</p><ul><li>cro_terminate - deallocate data structures</li></ul><h2 id="fdc*array*indexing-Array-indexing"><a class="docs-heading-anchor" href="#fdc*array*indexing-Array-indexing">fdc<em>array</em>indexing Array indexing</a><a id="fdc*array*indexing-Array-indexing-1"></a><a class="docs-heading-anchor-permalink" href="#fdc*array*indexing-Array-indexing" title="Permalink"></a></h2><p>Both C-style (0 based)and fortran-style (1-based) indexing is allowed. Choose control.f_indexing as false for C style and true for fortran style; add 1 to input integer arrays if fortran-style indexing is used, and beware that return integer arrays will adhere to this.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../cqp/">« cqp</a><a class="docs-footer-nextpage" href="../dgo/">dgo »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.23 on <span class="colophon-date" title="Wednesday 7 December 2022 22:13">Wednesday 7 December 2022</span>. Using Julia version 1.8.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
